{
  "sidecars": [
    {
      "name": "mysql",
      "image": "mysql:8.0.1",
      "env": [
        { "name": "MYSQL_ROOT_PASSWORD", "value": "nodepw" },
        { "name": "MYSQL_DATABASE", "value": "nodedb" },
        { "name": "MYSQL_USER", "value": "node" },
        { "name": "MYSQL_PASSWORD", "value": "nodepw" },
        { "name": "MYSQL_ROOT_HOST", "value": "0.0.0.0" }
      ],
      "readinessProbe": {
        "exec": {
          "command": ["sh", "-c", "mysql -h 0.0.0.0 -u node -p'nodepw' -e 'SELECT 1'"]
        },
        "initialDelaySeconds": 3,
        "periodSeconds": 2,
        "timeoutSeconds": 10
      }
    },
    {
      "name": "mongodb",
      "image": "mongo:4.1.13"
    },
    {
      "name": "mssql",
      "image": "mcr.microsoft.com/mssql/server:2022-RC1-ubuntu-20.04",
      "env": [
        { "name": "ACCEPT_EULA", "value": "Y" },
        { "name": "SA_PASSWORD", "value": "stanCanHazMsSQL1" },
        { "name": "MSSQL_PID", "value": "Express" }
      ]
    },
    {
      "name": "zookeeper",
      "image": "zookeeper:3.9.2",
      "readinessProbe": {
        "tcpSocket": {
          "port": 2181
        },
        "initialDelaySeconds": 5,
        "periodSeconds": 2,
        "timeoutSeconds": 30
      }
    },
    {
      "name": "kafka",
      "image": "wurstmeister/kafka:2.12-2.2.1",
      "env": [
        { "name": "KAFKA_LISTENERS", "value": "EXTERNAL://:9092,PLAINTEXT://:29092" },
        { "name": "KAFKA_ADVERTISED_LISTENERS", "value": "PLAINTEXT://127.0.0.1:29092,EXTERNAL://localhost:9092" },
        { "name": "KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR", "value": "1" },
        { "name": "KAFKA_LISTENER_SECURITY_PROTOCOL_MAP", "value": "PLAINTEXT:PLAINTEXT,EXTERNAL:PLAINTEXT" },
        { "name": "KAFKA_INTER_BROKER_LISTENER_NAME", "value": "PLAINTEXT" },
        {
          "name": "KAFKA_CREATE_TOPICS",
          "value": "test:1:1,test-topic-1:1:1,test-topic-2:1:1,test-batch-topic-1:1:1,test-batch-topic-2:1:1,rdkafka-topic:1:1,kafka-avro-topic:1:1"
        },
        { "name": "KAFKA_ZOOKEEPER_CONNECT", "value": "127.0.0.1:2181" }
      ],
      "readinessProbe": {
        "tcpSocket": {
          "port": 9092
        },
        "initialDelaySeconds": 30,
        "periodSeconds": 2,
        "timeoutSeconds": 60
      }
    },
    {
      "name": "postgres",
      "image": "postgres",
      "env": [
        { "name": "POSTGRES_USER", "value": "node" },
        { "name": "POSTGRES_PASSWORD", "value": "nodepw" },
        { "name": "POSTGRES_DB", "value": "nodedb" }
      ],
      "readinessProbe": {
        "exec": {
          "command": ["sh", "-c", "pg_isready --host 127.0.0.1 --port 5432 --dbname=nodedb"]
        },
        "initialDelaySeconds": 3,
        "periodSeconds": 2,
        "timeoutSeconds": 10
      }
    },
    {
      "name": "rabbitmq",
      "image": "rabbitmq:3.7.7",
      "readinessProbe": {
        "tcpSocket": {
          "port": 5672
        },
        "initialDelaySeconds": 7,
        "periodSeconds": 2,
        "timeoutSeconds": 60
      }
    },
    {
      "name": "redis",
      "image": "redis:5.0.14"
    },
    {
      "name": "localstack",
      "image": "localstack/localstack:latest"
    },
    {
      "name": "schema-registry",
      "image": "confluentinc/cp-schema-registry:4.1.0",
      "env": [
        { "name": "SCHEMA_REGISTRY_KAFKASTORE_CONNECTION_URL", "value": "127.0.0.1:2181" },
        { "name": "SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS", "value": "PLAINTEXT://127.0.0.1:29092" },
        { "name": "SCHEMA_REGISTRY_HOST_NAME", "value": "schema-registry" }
      ],
      "readinessProbe": {
        "httpGet": {
          "path": "/",
          "port": 8081
        },
        "initialDelaySeconds": 5,
        "periodSeconds": 2,
        "timeoutSeconds": 60
      }
    },
    {
      "name": "memcached",
      "image": "memcached:1.6.9"
    },
    {
      "name": "nats",
      "image": "nats:2.9.14-linux"
    },
    {
      "name": "nats-streaming",
      "image": "nats-streaming:0.25.3-linux",
      "args": ["-p", "4223", "-m", "8223"],
      "readinessProbe": {
        "httpGet": {
          "path": "/healthz",
          "port": 8223
        },
        "initialDelaySeconds": 5,
        "periodSeconds": 2,
        "timeoutSeconds": 15
      }
    },
    {
      "name": "nats-streaming-2",
      "image": "nats-streaming:0.25.3-linux",
      "args": ["-p", "4224", "-m", "8224"],
      "readinessProbe": {
        "httpGet": {
          "path": "/healthz",
          "port": 8224
        },
        "initialDelaySeconds": 5,
        "periodSeconds": 2,
        "timeoutSeconds": 15
      }
    },
    {
      "name": "elasticsearch",
      "image": "docker.elastic.co/elasticsearch/elasticsearch:8.6.1",
      "env": [
        { "name": "discovery.type", "value": "single-node" },
        { "name": "ES_JAVA_OPTS", "value": "-Xms500m -Xmx500m" },
        { "name": "xpack.security.enabled", "value": "false" }
      ]
    },
    {
      "name": "couchbase",
      "image": "couchbase/server:7.1.4",
      "readinessProbe": {
        "httpGet": {
          "path": "/",
          "port": 8091
        },
        "initialDelaySeconds": 15,
        "periodSeconds": 2,
        "timeoutSeconds": 60
      }
    }
  ]
}
