[
  {
    "Scenario": "no incoming headers",
    "What to do?": "Start a new trace",
    "Server-Timing": "intid;desc=$new_64_bit_trace_id",
    "entrySpan.t": "$new_64_bit_trace_id",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "$new_64_bit_trace_id",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "$new_64_bit_trace_id",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id_2-03",
    "tracestate out": "in=$new_64_bit_trace_id;$new_span_id_2",
    "index": 1
  },
  {
    "Scenario": "only Instana headers, 64 bit trace ID",
    "What to do?": "Continue the trace",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000fa2375d711a4ca0f-$new_span_id_2-03",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 2
  },
  {
    "Scenario": "Instana headers with 128 bit trace ID",
    "What to do?": "Continue the trace, limit the trace ID to 64 bit. Set span.lt but not span.tp.",
    "X-INSTANA-T in": "0373e5f7aca1cdef3483a5fe1cd42e30",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "Server-Timing": "intid;desc=3483a5fe1cd42e30",
    "entrySpan.t": "3483a5fe1cd42e30",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.lt": "0373e5f7aca1cdef3483a5fe1cd42e30",
    "exitSpan.t": "3483a5fe1cd42e30",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "3483a5fe1cd42e30",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0373e5f7aca1cdef3483a5fe1cd42e30-$new_span_id_2-03",
    "tracestate out": "in=3483a5fe1cd42e30;$new_span_id_2",
    "index": 3
  },
  {
    "Scenario": "Instana and traceparent, no tracestate",
    "What to do?": "Continue the trace from Instana headers, no span.lt/tp/ia",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 4
  },
  {
    "Scenario": "Instana, traceparent & tracestate without in kv pair",
    "What to do?": "Continue the trace from Instana headers, no span.lt/tp/ia",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 5
  },
  {
    "Scenario": "Instana, traceparent & tracestate with in kv pair",
    "What to do?": "Continue the trace from Instana headers, no span.lt/tp/ia",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,in=fa2375d711a4ca0f;02468acefdb97531,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 6
  },
  {
    "Scenario": "Instana and spec headers, X-INSTANA-T has a 128 bit trace ID",
    "What to do?": "Continue the trace from Instana headers, limit the trace ID to 64 bit. Set span.lt but not span.tp.",
    "X-INSTANA-T in": "0373e5f7aca1cdef3483a5fe1cd42e30",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=3483a5fe1cd42e30",
    "entrySpan.t": "3483a5fe1cd42e30",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.lt": "0373e5f7aca1cdef3483a5fe1cd42e30",
    "exitSpan.t": "3483a5fe1cd42e30",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "3483a5fe1cd42e30",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=3483a5fe1cd42e30;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 7
  },
  {
    "Scenario": "traceparent but no tracestate",
    "What to do?": "Continue the trace from traceparent, set span.lt and span.tp, but not span.ia",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "Server-Timing": "intid;desc=8448eb211c80319c",
    "entrySpan.t": "8448eb211c80319c",
    "entrySpan.p": "b9c7c989f97918e1",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.tp": true,
    "entrySpan.lt": "0af7651916cd43dd8448eb211c80319c",
    "exitSpan.t": "8448eb211c80319c",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "8448eb211c80319c",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=8448eb211c80319c;$new_span_id_2",
    "index": 8
  },
  {
    "Scenario": "traceparent and tracestate without in kv pair",
    "What to do?": "Continue the trace from traceparent, set span.lt and span.tp, but not span.ia",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=8448eb211c80319c",
    "entrySpan.t": "8448eb211c80319c",
    "entrySpan.p": "b9c7c989f97918e1",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.tp": true,
    "entrySpan.lt": "0af7651916cd43dd8448eb211c80319c",
    "exitSpan.t": "8448eb211c80319c",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "8448eb211c80319c",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=8448eb211c80319c;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 9
  },
  {
    "Scenario": "traceparent and tracestate with in kv pair",
    "What to do?": "Continue the trace from traceparent, set span.lt, span.tp, and span.ia",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,in=fa2375d711a4ca0f;02468acefdb97531,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=8448eb211c80319c",
    "entrySpan.t": "8448eb211c80319c",
    "entrySpan.p": "b9c7c989f97918e1",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.ia": {
      "t": "fa2375d711a4ca0f",
      "p": "02468acefdb97531"
    },
    "entrySpan.tp": true,
    "entrySpan.lt": "0af7651916cd43dd8448eb211c80319c",
    "exitSpan.t": "8448eb211c80319c",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "8448eb211c80319c",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=8448eb211c80319c;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 10
  },
  {
    "Scenario": "traceparent and tracestate with in kv pair (with a 128 bit trace ID)",
    "What to do?": "Continue the trace from traceparent, set span.lt, span.tp, and span.ia (trace ID as is, not shortened)",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,in=989743abc52a037ceb3486e822b4eb10;13579bdffaa86520,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=8448eb211c80319c",
    "entrySpan.t": "8448eb211c80319c",
    "entrySpan.p": "b9c7c989f97918e1",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.ia": {
      "t": "989743abc52a037ceb3486e822b4eb10",
      "p": "13579bdffaa86520"
    },
    "entrySpan.tp": true,
    "entrySpan.lt": "0af7651916cd43dd8448eb211c80319c",
    "exitSpan.t": "8448eb211c80319c",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "8448eb211c80319c",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=8448eb211c80319c;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 11
  },
  {
    "Scenario": "only X-INSTANA-L=0",
    "What to do?": "Don’t create spans, send X-INSTANA-L=0 and spec headers downstream with sampled=0",
    "X-INSTANA-L in": "0",
    "X-INSTANA-L out": "0",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id-02",
    "index": 12
  },
  {
    "Scenario": "X-INSTANA-L=0 plus -T and -S",
    "What to do?": "Don’t create spans, send X-INSTANA-L=0 and spec headers downstream with sampled=0",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "X-INSTANA-L in": "0",
    "X-INSTANA-L out": "0",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id-02",
    "index": 13
  },
  {
    "Scenario": "X-INSTANA-L=0 plus traceparent",
    "What to do?": "Don’t create spans, send X-INSTANA-L=0 and spec headers downstream with sampled=0",
    "X-INSTANA-L in": "0",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "X-INSTANA-L out": "0",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id-00",
    "index": 14
  },
  {
    "Scenario": "X-INSTANA-L=0 plus traceparent and tracestate",
    "What to do?": "Don’t create spans, send X-INSTANA-L=0 and spec headers downstream with sampled=0",
    "X-INSTANA-L in": "0",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "X-INSTANA-L out": "0",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id-00",
    "tracestate out": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 15
  },
  {
    "Scenario": "Instana headers, synthetic",
    "What to do?": "Continue the trace, span.sy=true",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "X-INSTANA-L in": "1",
    "X-INSTANA-SYNTHETIC in": "1",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.sy": true,
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000fa2375d711a4ca0f-$new_span_id_2-03",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 16
  },
  {
    "Scenario": "Instana headers, eum correlation",
    "What to do?": "Ignore the incoming trace ID and parent ID, start a new trace",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "X-INSTANA-L in": "1,correlationType=web;correlationId=1234567890abcdef",
    "Server-Timing": "intid;desc=$new_64_bit_trace_id",
    "entrySpan.t": "$new_64_bit_trace_id",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.crid": "1234567890abcdef",
    "entrySpan.crtp": "web",
    "exitSpan.t": "$new_64_bit_trace_id",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "$new_64_bit_trace_id",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id_2-03",
    "tracestate out": "in=$new_64_bit_trace_id;$new_span_id_2",
    "index": 17
  },
  {
    "Scenario": "w3c off, no incoming headers",
    "What to do?": "Start a new trace",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "true",
    "Server-Timing": "intid;desc=$new_64_bit_trace_id",
    "entrySpan.t": "$new_64_bit_trace_id",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "$new_64_bit_trace_id",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "$new_64_bit_trace_id",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id_2-03",
    "tracestate out": "in=$new_64_bit_trace_id;$new_span_id_2",
    "index": 18
  },
  {
    "Scenario": "w3c off, only Instana headers, 64 bit trace ID",
    "What to do?": "Continue the trace",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "yes",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000fa2375d711a4ca0f-$new_span_id_2-03",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 19
  },
  {
    "Scenario": "w3c off, Instana headers with 128 bit trace ID",
    "What to do?": "Continue the trace, limit the trace ID to 64 bit. Set span.lt but not span.tp.",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "certainly",
    "X-INSTANA-T in": "0373e5f7aca1cdef3483a5fe1cd42e30",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "Server-Timing": "intid;desc=3483a5fe1cd42e30",
    "entrySpan.t": "3483a5fe1cd42e30",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.lt": "0373e5f7aca1cdef3483a5fe1cd42e30",
    "exitSpan.t": "3483a5fe1cd42e30",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "3483a5fe1cd42e30",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0373e5f7aca1cdef3483a5fe1cd42e30-$new_span_id_2-03",
    "tracestate out": "in=3483a5fe1cd42e30;$new_span_id_2",
    "index": 20
  },
  {
    "Scenario": "w3c off, Instana and traceparent, no tracestate",
    "What to do?": "Continue the trace from Instana headers, no span.lt/tp/ia. (Keep in mind that any non-empty string disables W3C trace correlation, even „false“ or similar)",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "false",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 21
  },
  {
    "Scenario": "w3c off, Instana, traceparent & tracestate without in kv pair",
    "What to do?": "Continue the trace from Instana headers, no span.lt/tp/ia",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "yes_please",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 22
  },
  {
    "Scenario": "w3c off, Instana, traceparent & tracestate with in kv pair",
    "What to do?": "Continue the trace from Instana headers, no span.lt/tp/ia",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "w3c_trace_correlation_stinks",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,in=fa2375d711a4ca0f;02468acefdb97531,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 23
  },
  {
    "Scenario": "w3c off, instana and spec headers, X-INSTANA-T has a 128 bit trace ID",
    "What to do?": "Continue the trace from Instana headers, limit the trace ID to 64 bit. Set span.lt but not span.tp.",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "true",
    "X-INSTANA-T in": "0373e5f7aca1cdef3483a5fe1cd42e30",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=3483a5fe1cd42e30",
    "entrySpan.t": "3483a5fe1cd42e30",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.lt": "0373e5f7aca1cdef3483a5fe1cd42e30",
    "exitSpan.t": "3483a5fe1cd42e30",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "3483a5fe1cd42e30",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=3483a5fe1cd42e30;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 24
  },
  {
    "Scenario": "w3c off, traceparent but no tracestate",
    "What to do?": "Start new trace",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "yes",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "Server-Timing": "intid;desc=$new_64_bit_trace_id",
    "entrySpan.t": "$new_64_bit_trace_id",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "$new_64_bit_trace_id",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "$new_64_bit_trace_id",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=$new_64_bit_trace_id;$new_span_id_2",
    "index": 25
  },
  {
    "Scenario": "w3c off, traceparent and tracestate without in kv pair",
    "What to do?": "Start new trace",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "certainly",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=$new_64_bit_trace_id",
    "entrySpan.t": "$new_64_bit_trace_id",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "$new_64_bit_trace_id",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "$new_64_bit_trace_id",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=$new_64_bit_trace_id;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 26
  },
  {
    "Scenario": "w3c off, traceparent and tracestate with in kv pair",
    "What to do?": "Pick up the trace from tracestate/in.",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "false",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,in=fa2375d711a4ca0f;02468acefdb97531,rojo=00f067aa0ba902b7",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "02468acefdb97531",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2,congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 27
  },
  {
    "Scenario": "w3c off, only X-INSTANA-L=0",
    "What to do?": "Don’t create spans, send X-INSTANA-L=0 and spec headers downstream with sampled=0",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "yes_please",
    "X-INSTANA-L in": "0",
    "X-INSTANA-L out": "0",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id-02",
    "index": 28
  },
  {
    "Scenario": "w3c off, X-INSTANA-L=0 plus -T and -S",
    "What to do?": "Don’t create spans, send X-INSTANA-L=0 and spec headers downstream with sampled=0",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "w3c_trace_correlation_stinks",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "X-INSTANA-L in": "0",
    "X-INSTANA-L out": "0",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id-02",
    "index": 29
  },
  {
    "Scenario": "w3c off, X-INSTANA-L=0 plus traceparent",
    "What to do?": "Don’t create spans, send X-INSTANA-L=0 and spec headers downstream with sampled=0",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "true",
    "X-INSTANA-L in": "0",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "X-INSTANA-L out": "0",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id-00",
    "index": 30
  },
  {
    "Scenario": "w3c off, X-INSTANA-L=0 plus traceparent and tracestate",
    "What to do?": "Don’t create spans, send X-INSTANA-L=0 and spec headers downstream with sampled=0",
    "INSTANA_DISABLE_W3C_TRACE_CORRELATION": "yes",
    "X-INSTANA-L in": "0",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "X-INSTANA-L out": "0",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id-00",
    "tracestate out": "congo=ucfJifl5GOE,rojo=00f067aa0ba902b7",
    "index": 31
  },
  {
    "Scenario": "invalid traceparent and no tracestate",
    "What to do?": "Start a new trace",
    "traceparent in": "invalid-trace-parent",
    "Server-Timing": "intid;desc=$new_64_bit_trace_id",
    "entrySpan.t": "$new_64_bit_trace_id",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "$new_64_bit_trace_id",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "$new_64_bit_trace_id",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id_2-03",
    "tracestate out": "in=$new_64_bit_trace_id;$new_span_id_2",
    "index": 32
  },
  {
    "Scenario": "invalid (all zeroes) traceparent and no tracestate",
    "What to do?": "Start a new trace",
    "traceparent in": "00-00000000000000000000000000000000-0000000000000000-01",
    "Server-Timing": "intid;desc=$new_64_bit_trace_id",
    "entrySpan.t": "$new_64_bit_trace_id",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "$new_64_bit_trace_id",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "$new_64_bit_trace_id",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id_2-03",
    "tracestate out": "in=$new_64_bit_trace_id;$new_span_id_2",
    "index": 33
  },
  {
    "Scenario": "traceparent but no tracestate, sampled flag is 0",
    "What to do?": "Ignore the sampled flag, continue the trace from traceparent, set span.lt and span.tp, but not span.ia",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-00",
    "Server-Timing": "intid;desc=8448eb211c80319c",
    "entrySpan.t": "8448eb211c80319c",
    "entrySpan.p": "b9c7c989f97918e1",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.tp": true,
    "entrySpan.lt": "0af7651916cd43dd8448eb211c80319c",
    "exitSpan.t": "8448eb211c80319c",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "8448eb211c80319c",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=8448eb211c80319c;$new_span_id_2",
    "index": 34
  },
  {
    "Scenario": "tracestate header with more than 32 kv pairs",
    "What to do?": "Limit the tracestate header to 32 kv pairs, Instana kv pair is used before limiting",
    "traceparent in": "00-0af7651916cd43dd8448eb211c80319c-b9c7c989f97918e1-01",
    "tracestate in": "member01=value01,member02=value02,member03=value03,member04=value04,member05=value05,member06=value06,member07=value07,member08=value08,member09=value09,member10=value10,member11=value11,member12=value12,member13=value13,member14=value14,member15=value15,member16=value16,member17=value17,member18=value18,member19=value19,member20=value20,member21=value21,member22=value22,member23=value23,member24=value24,member25=value25,member26=value26,member27=value27,member28=value28,member29=value29,member30=value30,member31=value31,member32=value32,member33=value33,in=fa2375d711a4ca0f;02468acefdb97531,member34=value34,member35=value35",
    "Server-Timing": "intid;desc=8448eb211c80319c",
    "entrySpan.t": "8448eb211c80319c",
    "entrySpan.p": "b9c7c989f97918e1",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.ia": {
      "t": "fa2375d711a4ca0f",
      "p": "02468acefdb97531"
    },
    "entrySpan.tp": true,
    "entrySpan.lt": "0af7651916cd43dd8448eb211c80319c",
    "exitSpan.t": "8448eb211c80319c",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "8448eb211c80319c",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0af7651916cd43dd8448eb211c80319c-$new_span_id_2-01",
    "tracestate out": "in=8448eb211c80319c;$new_span_id_2,member01=value01,member02=value02,member03=value03,member04=value04,member05=value05,member06=value06,member07=value07,member08=value08,member09=value09,member10=value10,member11=value11,member12=value12,member13=value13,member14=value14,member15=value15,member16=value16,member17=value17,member18=value18,member19=value19,member20=value20,member21=value21,member22=value22,member23=value23,member24=value24,member25=value25,member26=value26,member27=value27,member28=value28,member29=value29,member30=value30,member31=value31",
    "index": 35
  },
  {
    "Scenario": "redact secrets from http query params",
    "What to do?": "redact the secrets according to the configuration",
    "query in": "Password=myP4sswd&very-secret-param=secret-value&TOKEN=token_value&api_key=keep-this-value",
    "Server-Timing": "intid;desc=$new_64_bit_trace_id",
    "entrySpan.t": "$new_64_bit_trace_id",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.params": "Password=<redacted>&very-secret-param=<redacted>&TOKEN=<redacted>&api_key=keep-this-value",
    "exitSpan.t": "$new_64_bit_trace_id",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "exitSpan.params": "Password=<redacted>&very-secret-param=<redacted>&TOKEN=<redacted>&api_key=keep-this-value",
    "X-INSTANA-T out": "$new_64_bit_trace_id",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000$new_64_bit_trace_id-$new_span_id_2-03",
    "tracestate out": "in=$new_64_bit_trace_id;$new_span_id_2",
    "index": 36
  },
  {
    "Scenario": "request headers on entry spans",
    "What to do?": "capture request headers on incoming HTTP requests",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "request headers in": "X-Request-Header-Test-To-App: Value 1",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.headers": "X-Request-Header-Test-To-App: Value 1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000fa2375d711a4ca0f-$new_span_id_2-03",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 37
  },
  {
    "Scenario": "response headers on entry spans",
    "What to do?": "capture response headers on incoming HTTP requests",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.headers": "X-Response-Header-App-To-Test: Value 4",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000fa2375d711a4ca0f-$new_span_id_2-03",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 38
  },
  {
    "Scenario": "request headers on exit spans",
    "What to do?": "capture request headers on outgoing HTTP requests",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "exitSpan.headers": "X-Request-Header-App-To-Downstream: Value 2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000fa2375d711a4ca0f-$new_span_id_2-03",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 39
  },
  {
    "Scenario": "response headers on exit spans",
    "What to do?": "capture response headers on outgoing HTTP requests",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "exitSpan.headers": "X-Response-Header-Downstream-To-App: Value 3",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000fa2375d711a4ca0f-$new_span_id_2-03",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 40
  },
  {
    "Scenario": "INSTANA_SERVICE_NAME support / entry span",
    "What to do?": "add span.data.service on entry span",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "entrySpan.data.service": "Tracer Test Suite Service",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000fa2375d711a4ca0f-$new_span_id_2-03",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 41
  },
  {
    "Scenario": "INSTANA_SERVICE_NAME support / exit span",
    "What to do?": "add span.data.service on exit span",
    "X-INSTANA-T in": "fa2375d711a4ca0f",
    "X-INSTANA-S in": "37cb2d6e9b1c078a",
    "Server-Timing": "intid;desc=fa2375d711a4ca0f",
    "entrySpan.t": "fa2375d711a4ca0f",
    "entrySpan.p": "37cb2d6e9b1c078a",
    "entrySpan.s": "$new_span_id_1",
    "exitSpan.t": "fa2375d711a4ca0f",
    "exitSpan.p": "$new_span_id_1",
    "exitSpan.s": "$new_span_id_2",
    "exitSpan.data.service": "Tracer Test Suite Service",
    "X-INSTANA-T out": "fa2375d711a4ca0f",
    "X-INSTANA-S out": "$new_span_id_2",
    "X-INSTANA-L out": "1",
    "traceparent out": "00-0000000000000000fa2375d711a4ca0f-$new_span_id_2-03",
    "tracestate out": "in=fa2375d711a4ca0f;$new_span_id_2",
    "index": 42
  }
]